>要求硕士，也不知道我本科投会不会有人搭理。

## 8.14-约笔试 | 8.15-笔试

C++语法题目

## 8.21-约一面 | 8.24-一面
>共两次技术面，一次HR面

顺着简历聊的

1. 询问能否录屏
2. 自我介绍

+ 实习：
	+ 我看你做了Curve的Curve Tool，它本身是怎么工作的？是调用了C++的接口还是？
	+ 如果是你做项目的话，对于C++、Golang这种语言的选择是怎样考虑的呢？
	+ 那量化交易系统为什么用Python
	+ 策略是如何设计的？通过什么数据？
		+ 我不是做策略的，我给面试官讲了基于事件类型的量化交易系统和基于轮询式的量化交易系统的差异，进而讲了自己的产出。
	+ 网络使用Flask，有哪些高并发的场景？你是怎么应对的
		>并发并不高，因为产品形态是通过策略卖整个软件，这里提供客户，用户将软件（联通策略）拿到自己机器上去运行。

	+ 两个项目分别用的时间
	+ 了解Ceph嘛？  
		听过名字，讲了组内业务，然后虽然我不了解Ceph，但是我还知道MapReduce和Raft呀，面试官您要听么？

+ 项目：Modern C++实现Redis
	+ 如何用RAII管理Socket  
		我讲了我的幼稚的方案和CS144中的方案

	+ 对于不可拷贝，怎么实现？
		+ 知道`Rule of one/zero` and `Rule of five`么？  
			倒也称不上Rule吧，Modern C++的几个标准函数/拷贝构造函数需要相辅相成，当类中需要管理堆内存时，拷贝构造函数、拷贝赋值运算符、析构函数需要一同设置，此即为`Rule of one`，如果需要移动语义，则还需要实现移动构造函数和移动赋值运算符，此即为`Rule of five`，至于`Rule of zero`没听过，也查不到
	+ 我看你用了AVL树了
		+ Redis支持什么类型？  
			讲完后我又扯到了侵入式数据结构的特点，在Redis的应用，进而扯到了解释器的Union Tag
		+ 除了AVL树之外还有一个平衡树是红黑树RBTree
			+ 讲讲两者差异->对于查询和插入，分析两个数据结构差异，为什么
				AVL是严格平衡树而红黑树是大致平衡的，所有在修改是，前者的旋转次数应该大于后者，也正因为AVL的平衡，所有在搜索中，前者的平均复杂度应该更低。
			+ 项目中既然不用Redis使用的跳表而是选择用AVL树，为什么不使用红黑树呢？
	+ 为什么想实现Redis
	+ Redis的应用场景你应该很熟悉吧？
		>你们写数据库的都很会SQL？


		数据全局共享：Redis服务是单独分出去一个服务器，所有其他服务器可以以Redis服务器为中间人共享数据  
		分布式锁、全局ID：利用一些原子操作  
		计数器，对于小额多次的变动，不要每次都写入数据库，先在Redis这里写下，定期存

		+ 场景题：对于恶意爬虫或工具，怎么缓解Redis压力？

	+ 我看你很喜欢Modern的东西嘛，这个`std::call_one`，你给讲一下
		cppref：
		```cpp
		template< class Callable, class... Args > void call_once( std::once_flag& flag, Callable&& f, Args&&... args );
		```
		1. 如果flag表明f已经执行，则立刻返回
		2. 否则则执行，这个执行没有移动、没有开额外线程
			1. 如果异常，则异常返回到调用方，而flag不被设置
			2. 如果正常结束则flip flag，来保证其他的调用是情况1

		这个表述有点问题，比如既然有一个函数结束才标记flag，那么不会同时有多个线程都进入函数，然后只有一个线程设置flag，这是其他的怎么办？

		康康源码：  
		算了，我clang挂了

		但是还指的一题的是，C++11局部静态变量的初始化会保证线程安全（即**magic statics**），所有可以一定代替call_once
		
		+ 这个是C++11才有的，之前如果想实现同样的目的怎么实现，单例模式了解么？

			单例模式：一个类专门用于创建另一个类，并且里面有一个变量，来维护是否已经创建（或者使用指针，如果指针为空则没有创建），在多线程的情况下加个锁即可

			更C++的单例模式（ygg）：在上面说的中，对于`new`这个操作，一般是申请空间，然后在空间中构造，然后将这个空间的地址给到对应变量，但是可能调换顺序，即先将地址空间放到对应位置，但是构造这个操作是可能出现异常的，这是就聊到异常安全，异常安全指的是当异常发生时：不会泄露资源、系统不会进入不一致状态。通常有三个级别，基本安全、强烈保证、不抛异常保证，保证一次增强。那么怎么让单例变的更异常安全呢？即使用Magic Statics，由编译器保证线程安全。

		+ 如果有多个线程调用有`call_one`的函数，究竟哪个线程会成功运行呢？这个函数会被调用几次呢？
		+ 下面的代码，输出是什么？
			```cpp
			#include <iostream>
			#include <mutex>
			#include <thread>
			
			std::once_flag flag;
			
			void call_func(int i) {
			  if (i > 0) {
			    throw -1;
			  }
			  std::cout << i << std::endl;
			}
			
			void test_func(int i) {
			  try {
			    std::call_once(flag, call_func, i);
			  } catch (int ei) {
			    // nothing
			  }
			}
			
			int main() {
			  std::thread t1(test_func, 1);
			  std::thread t2(test_func, 2);
			  std::thread t3(test_func, 0);
			
			  t1.join();
			  t2.join();
			  t3.join();
			
			  return 0;
			}
			```

+ 虚拟机：
	+ 介绍下什么是栈式虚拟机
	+ 栈式和寄存器式虚拟机，还有什么类型的？  
		没有所在的虚拟机，直接在AST上运行，不知道这种算不算虚拟机
	+ 都有哪些使用栈式虚拟机的常用的编程语言？
		+ Python、Java
		+ Lua是基于栈式的，但是LuaJIT是基于寄存器式的

+ CS144：
	+ 计算机网络的哪几层比较熟？介绍下
	+ 关于TCP的状态转移，讲一下
		![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/recruit/TCP状态转移.png)
	+ TCP字节流缓存  
		我个人使用的二倍大小循环链表
	+ TCP重排器：怎么解决字节重叠  
		个人使用有序链表表示区间，对于重叠区间合并（题目不保证重叠但是对应位置不出错）
		+ 不出错？如果出错了呢？
	+ 最后有测试性能么？

+ 简历的东西讲完了，我们写个代码题吧：  
	一个链表，我们在原链表的相邻结点中都分别插入一个新结点，新节点的内容是相邻两个结点的最大公约数，比如`5 10 16`变成`5 5 10 2 16`

+ 闲聊
	+ 为什么投递我司
	+ 大四安排
	+ 爱好

+ 反问：
	+ 我投递的岗位的工作内容是什么，相关业务是什么？
	+ 组内平均学历和学校层次。

整个节奏规规矩矩的，谢谢面试官，体验挺好。

+ 复盘总结：太紧张啦
	+ 听问题听完再回答
	+ 回答前总结下整体思路

## 8.25-约二面 | 8.30-二面
