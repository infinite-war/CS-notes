+ 资料：
	+ 一个简单的入门[网站](https://linux.cn/article-6160-1.html)
	+ 《鸟哥的Linux私房菜》

+ 规矩：终端即为一个shell的解释器
	+ `q`或`Esc`退出
	+ 参数支持正则表达式

+ 使用习惯：
	+ `Ctrl + u`：清空本行命令
	+ `Ctrl + c`：终止当前命令
	+ `Tab`：补全命令或文件，对于多选项双击Tab显式备选选项
	+ 方向键`up`：上一条命令
	+ `Ctrl + l`：刷新屏幕

# misc

+ `man 命令`：查看命令手册  
+ 通常命令会提供`--help`参数
+ `type 命令`：查看命令类型
+ `strace 命令`：检查命令使用的系统调用
---
+ 工具：
	+ `md5sum`：计算md5哈希值：
		+ 可从`stdin`读入内容：执行命令 -> 输入内容 -> `Ctrl + z`
		+ 可从命令行参数传入文件名列表
	+ `time command`：统计`command`命令的执行时间
	+ `watch -n 0.1 command`：每0.1秒执行一次`command`命令
	+ `tar`：压缩文件
		+ `tar -zcvf xxx.tar.gz /path/to/file/*`：压缩
		+ `tar -zxvf xxx.tar.gz`：解压缩
	+ `diff XXX YYY`： 查找文件XXX与YYY的不同点

## 基操
+ `pwd`：显式当前绝对路径
+ `ls`：
	+ `ll`
+ `cd`：
	+ `cd ..`：
+ `cp sourcefile distfile`：copy
+ `rm file`：remove  
	`rm dir -r`
+ `mv sourcefile distfile`：move or rename
+ `mkdir dir`
+ `touch file`
+ `cat file`
+ `chmod`：修改文件权限
	+ `chmod +x XXX`：给XXX添加可执行权限
	+ `chmod -x XXX`：去掉XXX的可执行权限
	+ `chmod 777 XXX`：将XXX的权限改成777
	+ `chmod 777 XXX -R`：递归修改整个文件夹的权限

## 重定向和管道

+ 每个进程默认打开3个文件描述符：
	+ `stdin`标准输入，从命令行读取数据，文件描述符为`0`
	+ `stdout`标准输出，向命令行输出数据，文件描述符为`1`
	+ `stderr`标准错误输出，向命令行输出数据，文件描述符为`2`
	可以用文件重定向将这三个文件重定向到其他文件中。

+ 重定向命令列表

	| 命令              | 说明                                          |
	| ----------------- | --------------------------------------------- |
	| `command > file`  | 将stdout重定向到file中                        |
	| `command < file`  | 将stdin重定向到file中                         |
	| `command >> file` | 将stdout以追加方式重定向到file中              |
	| `command n> file` | 将文件描述符n重定向到file中<br> `2>`错误输出 |
	| `command n>> file`                   | 将文件描述符n以追加方式重定向到file中<br>样例同上                                              |

+ 管道：将前一个命令的`stdout`重定向给下一个命令的`stdin`
	+ 只能处理`stdout`，会忽略`stderr`
	+ 要求管道右边的命令必须能接受`stdin`
	+ 可串联

+ `xargs`命令：

# 运维
+ `tree`：展示当前目录的文件结构

## 文件
+ 查找：
	+ 按文件名查找文件：`find 路径 -name 正则表达式`
	+ 在文件中检索内容：`grep 正则表达式 文件名`
	+ 在当前目录中检索内容：`ag 正则表达式`
	+ 内容统计：`wc`：统计行数、单词书、字节数：既可以从`stdin中`直接读入内容；也可以在命令行参数中传入文件名列表
		+ 参数：`-l`：统计行数；`-w`：统计单词数；`-c`：统计字节数

+ 查看文件内容：
	+ `cat`
	+ `more`：浏览文件内容：
		+ `回车`：下一行
		+ `空格`：下一页
		+ `b`：上一页
		+ `q`：退出
	+ `less`：与more类似，功能更全
		+ `回车`：下一行
		+ `y`：上一行
		+ `Page Down`：下一页  
		+ `Page Up`：上一页
		`q`：退出
	+ `head -3 xxx`：展示xxx的前3行内容  
		同时支持从stdin读入内容  
		`cat file | head -10`查看file开头10行内容
	+ `tail -3 xxx`：展示xxx末尾3行内容  
		同时支持从stdin读入内容  
		组合机同head

+ `cut`：  
	从stdin中读入多行数据  
    `echo \$PATH | cut -d ':' -f 3,5`：输出PATH用:分割后第3、5列数据  
    `echo \$PATH | cut -d ':' -f 3-5`：输出PATH用:分割后第3-5列数据  
    `echo \$PATH | cut -c 3,5`：输出PATH的第3、5个字符  
    `echo \$PATH | cut -c 3-5`：输出PATH的第3-5个字符

+ `sort`：将每行内容按字典序排序，可从`stdin`内读取多行，可从参数读取文件名列表

## 进程

+ `top`：查看所有进程的信息（Linux的任务管理器）
	+ 打开后，输入`M`：按使用内存排序
	+ 打开后，输入`P`：按使用CPU排序
	+ 打开后，输入`q`：退出

+ `ps aux`：查看所有进程
	+ `kill -9 pid`：杀死编号为pid的进程
		>本质是向某个进程传递信号：`kill -s SIGTERM pid`

# 存储

+ `df -h`：查看硬盘使用情况
+ `free -h`：查看内存使用情况
+ `du -sh`：查看当前目录占用的硬盘空间
+ `lsblk`

# 网络

+ `ping`
+ SSH：[我的教程](https://github.com/zweix123/CS-notes/blob/master/Missing-Semester/SSH.md)

# Shell
+ Shell中的空格有含义
+ Linux下的shell语言种类很多，默认bash
	+ 文件后缀名`.sh`
	+ 脚本需要在文件开头`#! /bin/bash`来指明bash为脚本解释器
+ 运行方式：
	+ 1. `chmod +x test.sh`：把脚本`test.sh`具有可执行权限  
		可以把`test.sh`作为可执行文件运行（当前路径、绝对路径、家目录路径）
	+ 2. 解释器运行：`bash test.sh`
+ 注释：
	1. 单行注释：`#`：注释每行之后的内容
	2. 多行注释：
```bash
:<<EOF
这里是注释
这还是一个注释
EOF
命令
# 这里的`EOF`可以换成其他任意字符串
```

+ 引入外部脚本：
	```bash
	. filename  # 空格隔开  # 1
	source filename        # 2
	```

## 变量

+ 定义变量：
  ```bash
  sam='string'
  sam="string"
  sam=string
  ```
  上面这三种方法都是定义字符串  
  + 字符串：
    + 单引号：内容原样输出、不会执行、不会取变量——真文本
    + 双引号：内容                   可以执行、可以去变量——代码
    > ssh中的`ssh ... commond`相反

  + 获取字符串长度：`${#字符串变量名}`
  + 提取子串：`${字符串变量名:第一个索引（从0开始）:子串长度}`
+ 使用变量：在变量名前加上`$`或者使用`${}`符号
  + 在后续的使用中，可能还要把取变量后的结果在用引号括起来，因为比如变量是字符串变量且中间有空格，同时取变量后作为参数，这时空格导致这是多个参数
+ 只读变量：
  ```bash
  sam=string
  readonly sam
  declare -r name
  ```
  以上两种方式均可

+ 删除变量：
  ```bash
  sam=string
  unset sam
  ```
  删除之后其内容为一个空字符串

+ 变量类型：
  > 子进程：命令bash会开一个新进程，原进程睡眠，exit/Ctrl + d退出当前bash

  1. 自定义变量/局部变量：子进程不能访问的变量
  2. 环境变量/全局变量：子进程可以访问的变量
  + 自定义变量改成环境变量：
    ```bash
    sam=string  # 定义自定义变量
    export name
    declare -x name
    ```
    以上两种方法均可
  + 环境变量改为自定义变量：
    ```bash
    export sam=string  # 定义环境变量
    declare +x name
    ```
+ 文件参数变量（默认变量）：执行shell脚本时，可向脚本传递参数

  | 参数         | 说明                                                         |
  | ------------ | ------------------------------------------------------------ |
  | `$数字`      | `$0`是文件名<br>对应参数从1开始                              |
  | `$#`         | 代表文件传入的参数个数                                       |
  | `$*`         | 由所有参数构成的用空格隔开的字符串                           |
  | `$@`         | 每个参数分别用双引号括起来的字符串                           |
  | `$$`         | 脚本当前运行的进程ID                                         |
  | `$?`         | 上一条命令的退出状态（注意不是stdout，而是exit code）。0表示正常退出，其他值表示错误 |
  | `$(command)` | 返回command这条命令的stdout（可嵌套）                        |
  | \`command\`  | 返回command这条命令的stdout（不可嵌套）这里的点是有效的      |

  + 后两个比如：
    ```bash
    #! /bin/bash
    echo $(ls)
    echo 'ls'
    ```


## 环境变量
记录配置信息，可被各个进程访问到

+ 查看方法：
	+ `env`：查看当前用户的变量
	+ `set`：显示当前shell的变量，包含当前用户的变量
	+ `export`：显示当前到处成用户环境变量的shell变量
	+ `echo $变量名`：输出某环境变量的值

+ 修改：将对环境变量的修改放在当前用户使用的bash的rc文件末尾，然后`source ./.*rc`

+ 常用环境变量：
	+ `HOME`：
	+ `PATH`：可执行文件（命令）的存储路径，用`:`分割，从左到右执行

  + `alias ls="ls --color"`设置别名，或者写入到`~/.bashrc`文件中

## 数组

shell的数组可以存放**不同类型的值**，只支持一维数组，**下标从0开始**

+ 定义：
	+ 1. 用小括号表示，元素用空格隔开：`array=(sam1 sam2 sam3...)`
	+ 2. 直接定义数组中某个元素的值：`array[索引]=值`

	>这里显然可以在一个较大的位置赋值，但是其中没有用到的索引是空的，没有空间

+ 读取：
  + 某个元素：`${array[index]}`
  + 整个数组：
    + 1. `${array[@]}`
    + 2. `${array[*]}`
  + 取数组长度：`${#array}`

## 命令

### `expr`

用于求表达式的值：`expr 表达式`

+ 表达式说明：
	+ 用空格隔开每一项
	+ 用反斜杠放在shell特定的字符前面
	+ 对于包含空格和其他特殊字符的字符串要用引号括起来
	+ `stdout`：expr的返回值，则需要文件参数变量获得结果  
		`exit code`：如果表达式是逻辑表达式则和其统一：0/1

+ 字符串表达式：
  + `length STRING`：返回STRING的长度
  + `index STRING CHARSET`：返回set中任意单个字符在string中最前面的字符的位置，**索引从1开始**，如果set中一个都不存在则返回0
  + `substr STRING POSITION LENGTH`：同上，如果后两个参数不合法则返回空字符串

+ 整数表达式：算术表达式优先级低于字符串表达式，高于逻辑表达式
	+ `+ - * / % ( )`：参数会转换成整数
		+ `* ( )`需要转义，除了转义之外还可以用单引号把特殊符号括起来
		+ 只能处理整数

+ 逻辑关系表达式：下列符号都需要转义
	+ `| &`：是关系不是位运算：返回对应的值（非空且非0） + 短路原则
	+ `< <= = == != >= >`：返回真假，`=`和`==`同义，优先转换成整数，不能则转换成字符集
	+ `( )`：改变优先级，需要反斜杠转义

### `read`

+ 用于从标准输入中读取单行数据
当读到文件结束符时，`exit code`为1，否则为0
+ 参数：
	+ `read 变量名`：向变量名读入
	+ `-p`：后接提示信息
	+ `-t`：后接秒数：输入字符的等待时间，超过则忽略该命令

### `echo`

标准输出stdout
+ 用于输出字符串。命令格式：`echo STRING`
+ 显示普通字符串：`echo "普通字符串"`其中引号可以省略
+ 显示转义字符：只能使用双引号或者不使用引号
+ 显示变量：
+ 显示换行    ：`echo -e "字符串\n"  # -e 开启转义`  
	显示不换行：`echo -e "字符串\c"  # -e 开启转义`
+ 显示结果定向至文件：`>`
+ 不进行转义或取变量：用单引号
+ 显示命令执行的结果： 用波浪线下边的点

### `printf`

格式化输出：`printf format-string [arrguments...]`

### `test`和`[]`

+ 逻辑运算符：`&& ||`：具有短路原则：`exit code`为0是真，非0是假
	>之前的单与单或是expr内部的，这里的双与和双或是Shell内的

	+ 可用于分支

+ `test`：用于判断文件类型和文件比较（用`exit code`返回结果，而不使用`stdout`：0真、非0假）

+ 文件类型判断：`test -e filename`

    | 测试参数 | 含义                               |
    | -------- | ---------------------------------- |
    | `-e`     | 文件是否存在                       |
    | `-f`     | 是否为文件                         |
    | `-d`     | 是否为目录，也能判断文件夹是否存在 |

+ 文件权限判断：`test -r filename`

    | 测试参数 | 含义           |
    | -------- | -------------- |
    | `-r`     | 文件是否可读   |
    | `-w`     | 文件是否可写   |
    | `-x`     | 文件是否可执行 |
    | `-s`     | 是否为非空文件 |

+ 整数间的比较：`test 操作数1 操作符参数 操作数2`

    | 测试参数 | 代表意义                 |
    | -------- | ------------------------ |
    | `-eq`    | 是否等于                 |
    | `-ne`    | 不等于                   |
    | `-gt`    | 左操作数是否大于右操作数 |
    | `-lt`    | 小于                     |
    | `-ge`    | 大于等于                 |
    | `le`     | 小于等于                 |

+ 字符串比较：

    | 测试参数            | 代表意义                         |
    | ------------------- | -------------------------------- |
    | `test -z STRING`    | 判断是否为空，空为真             |
    | `test -n STRING`    | 是否为非空，非空为真，`-n`可省略 |
    | `test str1 == str2` |                                  |
    | `test str1 != str2` |                                  |

+ 多重条件判定：和逻辑运算符等效：`test -r filename -a -x filename`

    | 测试参数 | 代表意义           |
    | -------- | ------------------ |
    | `-a`     | 同时               |
    | `-o`     | 至少一             |
    | `!`      | 取反（后面的结果） |

---

+ 判断符号`[]`：`[]`与test用法几乎一模一样，更常用于`if`语句中。另外`[[]]`是`[]`的加强版，支持的特性更多。
	+ `[]`内的每一项都要用空格隔开
	+ 中括号内的变量，最好用双引号括起来
	+ 中括号内的常数，最好用单或双引号括起来

### `exit`

exit命令用来退出当前shell进程，并返回一个退出状态；使用`$?`可以接收这个退出状态。  
exit命令可以接受一个整数值作为参数，代表退出状态。如果不指定，默认状态值是0。  
exit退出状态只能是一个介于 0~255 之间的整数，其中只有 0 表示成功，其它值都表示失败。  

## 循环分支
```shell
%%if%%
if condition
then
	...
fi  %%结尾%%

---

if condition
then
	...
else
	...
fi

---

if condition
then 
	...
elif condition
then
	...
...
else
	...
fi

----

%%case%%

case $(变量) in
	value1)
		...
		;;  %%相当于break%%
	...
	*)  %%可选%%
		...
		;;
esac

----

for var in val1 val2 val3...
do
	...
done

%%
+ 参数：
	1. 一系列值
	2. 其他命令结果
	3. $(sep st ed)
	4. {st...ed}：...是关键字，参数可以是数字或者是字母
%%

---

for ((exp; condition; exp))
do
	...
done

---

until condition  %%真结束%%
do
	...
done

+ break：跳出当层循环
+ continue：跳过当前循环
```

## 函数
+ 函数的return是exit code：0-255的值，0表示正常结束，代码上不显式写return，默认return 0
+ 调用：
	+ `$(fname)`：获得stdout
	+ `$?`（在调用后使用）：获得exit code
+ 语法：
	```shell
	[function] func_name() {
		...
	}
	```
	+ 函数参数：直接在函数体中通过`$数字`使用
		>`$0`是文件名，不是函数名

	+ 局部变量：`local 变量名=变量值`