
+ 别名：对称密码、对称密钥(Symmetric-key)、秘密密钥(Secret-key)、单密钥(Single-key)方案/算法

+ 概念：

  + 明文(plaintext/cleartext) $x$：

  + 密文(ciphertext) $y$：

  + 密钥(key) $k$：

    > 加密：$e_k(x) \rightarrow y$、解密：$d_k(y) \rightarrow x$

    + 密钥空间(key space)：所有可能密钥组成的集合

+ 替换密码方法：加密文本：密钥：替换表；算法：替换文本。

  + 攻击方式：
    1. 蛮力攻击/穷尽密钥搜索：已知一段明文及其位置，遍历密钥空间，查看是否替换正确
    2. 字母频率分析：字母占比，不用字符组合占比，高频短词占比

+ 对称密码学：将每个明文映射为一个数位序列
  + 序列密码：单独加密每个位
    + 同步序列密码：仅取决于密钥
    + 异步序列密码：取决于密文和密钥
  + 分组密码：使用相同的密钥加密整个明文位分组

## 序列密码

+ 加密和解密的方案：加法模2——XOR运算：算法可逆+结果概率相同（异或的性质）

#### 随机数

+ 随机数生成器（RNG）：

  + 真随机数生成器（TRNG）：输出几乎不可复制，基于物理过程
  + （通用的）伪随机数生成器（PRNG）：从一个初始种子值通过计算得到序列
    + 线性同余生成器
      $$\begin{matrix}S_0 = seed \hfill \\ S_{i = 1} \equiv AS_{i} + B \ mod \  m, \ i = 0, 1\end{matrix}$$
    
  + 加密安全的伪随机数发生器（CSPENG）：PRNG的特例
    + 给定连续位，不存在一个时间复杂度为多项式的算法使得成功预测下一位的概率超过50%

> + 无条件安全：密码体制在无限计算资源的情况下仍不能破译
>
>   计算安全：如果破解一个密码体制，**最好的已知**算法需要至少t个操作
>
>   + 比较：10k位，在无限资源下，$2^{10k}$台计算机，但已知宇宙不过$2^{266}$个原子，这种密钥是计算安全。
>
> + 一次一密(OTP)：无条件安全
>
>   + 通过真随机数生成器得到密钥序列  ——要有TRNG
>   + 只有合法的通信方才知道密钥序列  ——密钥如何传递
>   + 每个密钥序列位仅使用一次             ——与明文一样长的密钥

+ 利用PRNG构建密码流：不可行

  + 守：使用基于线性同余发生器的PRNG
    1. 密钥包含系数、常数，可能包含种子，模数是加密方案的一部分

  + 攻：知道明文的前若干位，同时显然知道密文，从而可计算密钥的前若干位，如果此若干位足够得到PRNG的前3组输出符号，即可组成包含两个等式的线性等式系统，从而得到密钥（系数和常数）

    > 可能有多解，但如果得到再多一组，就能保证唯一解

+ 利用CSPRNG构建密钥序列：可解决上述问题，关键仍是随机数的生成

### LFSR

线性反馈移位寄存器(LFSR)：一种密钥流生成器，本质仍是随机数的创造

+ 组成：若干时钟存储元件（触发器）和一个反馈路径组成

  + 度：存储元件的个数
  + 反馈为系统中某些触发器的XOR和

+ 数学描述：

  <img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/Math/Cryptology/LFSR数学描述.jpg" style="zoom: 67%;" />

  <img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/Math/Cryptology/LFSR数学描述2.jpg" style="zoom:67%;" />

  + 其中$p$是一种开关，将选择的数进行累异或，从而得到新位（之前的位右移，多余的位为新密钥位）
  + 最大序列长度：$2^m - 1$
  + 上述的反馈系数向量$(p_{m - 1}, ..., p_1, p_0)$可表示为$P(x) = x^m + p_{m - 1}x^(m - 1) + ... + p_1x + p_0$
    + 作用：本源多项式(primitive polynomial)：不可约分的多项式

+ 实际应用：密钥即为反馈系数向量

+ 攻击：获得一定的明文密文，尝试可能的LFSR的度，分别建立对应数目的线性等式系统（解此很快）；

  ​           若确定度的大小，反馈系数即可得。

#### Trivium

+ 密钥长度80位，基于三个反馈移位寄存器（长度分别为93+84+111=288）

### eSTREAM项目

## 分组密码

+ 数据加密标准(Data Encryption Standard, DES)：主流的分组密码，是研究最透彻的对称算法
+ 强加密算法：
  + 混淆(Confusion)：使密钥与密文之间的关系尽可能模糊的加密操作
  + 扩散(Diffusion)：为了隐藏明文的统计属性而将一个明文符号的影响扩散到多个密文符号的加密操作

+ 操作模式：加密模式：
  + 电子密码本模式(electronic code book mode, ECB)：将明文划分为定长等份（不足填充），对组进行加密，加密方式和解密方式可逆
    + 优点：分组可异步，噪音只影响单组，可并行处理
    + 缺点：加密高度确定，流量分析识别密文是否传输多次，分组独立
  + 密码分组链接模式(CBC)：
  + 输出反馈模式(OFB)：
  + 密码反馈模式(CFB)：
  + 计数器模式(CTR)：

### DES算法

+ 概念：

  + 使用56位密钥对64位长分组进行加密的密码
  + 对称密码——加密和解密使用相同的密钥
  + 迭代算法：对每组的加密过程包含**16轮**，每轮的**操作**完全相**同**，使用不同**子密钥**，子密钥从主密钥中推导出来
  + 算法流程：Feistel网络：<img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/Math/Cryptology/Feistel网络.jpg" style="zoom: 67%;" />
  
    + $f$函数加密：<img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/Math/Cryptology/f.jpg" style="zoom:66%;" />子密钥推导<img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/resource/Math/Cryptology/DES密钥移位.jpg" style="zoom:67%;" />

> 置换表：每个位置有个数字，即为这个位置的数字本来的位置

+ 对于明文64位和密钥64位：

  1. 对明文进行$\text{IP}$置换64位
  2. 对密钥进行$\text{PC}^{-1}$置换56位：密钥每8位在末尾设置奇偶校验位，在此消去，并置换

  + 16轮加密：

    1. 密钥56位的循环：

       1. 分成左右两部分CD组：分别进行移位（**移位位数与加密轮次有关**），结果作为下一轮的密钥
       2. 结果作为下一轮的密钥
       3. 结果做$\text{PC}^{-2}$置换得到子密钥48位进行加密

    2. 明文64位的处理：

       1. 分成左右两部分32位：

          + Left经过与$f$函数的输出结构异或成为下一轮Right
          + Right和子密钥一起进入$f$函数，同时本身成为下一轮Left，

       2. $f$函数：输入明文（Right32位和子密钥48位）

          1. 扩充$E(R_{i - 1})$48位：存在一位对两位的**扩散**

          2. 与子密钥异或48位

          3. 进入$S\text{-盒}$：非线性，算法的关键

             1. 48位分8组并编号6位
             2. 每组的6位：首尾形成二进制做对应S-盒的行，中间四位形成二进制做对应S-和的列
             3. 取出对应S-盒对应位置的**十进制数**
             4. 将十进制化为二进制4位

             合并32位

          4. 置换$\text{P}$32位

+ 攻击：
  + 穷尽密钥搜索攻击：因DES密钥空间小
  + 分析攻击：
+ 实现：
  1. 软件
  2. 硬件

#### DES替换

+ 3DES和DESX
+ 轻量级密码PRESENT

### AES算法

#### 伽罗瓦域
